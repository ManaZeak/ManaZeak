

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: view/UserInterface.js | ManaZeak</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
        
            <link type="text/css" rel="stylesheet" href="doc/jsDoc.style.css">
        
    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: auto; height: 13px">
        
            <a href="https://github.com/ManaZeak/ManaZeak" rel="noopener noreferrer" target="_blank">
                <img src="https://manazeak.org/static/img/logo/manazeak-text.svg" width="100%" height="100%">
            </a>
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">ManaZeak</a></h1>
        
            <span class="version">v0.2.1</span>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
    <div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="AboutModal.html">AboutModal</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="AboutModal_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="AboutModal.html#_closeButton">_closeButton</a></li><li><a href="AboutModal.html#_closeClickedEvtId">_closeClickedEvtId</a></li><li><a href="AboutModal.html#_footerCloseButton">_footerCloseButton</a></li><li><a href="AboutModal.html#_footerCloseEvtId">_footerCloseEvtId</a></li><li><a href="AboutModal.html#_modalOverlay">_modalOverlay</a></li><li><a href="AboutModal.html#_overlayClickedEvtId">_overlayClickedEvtId</a></li><li><a href="AboutModal.html#_rootElement">_rootElement</a></li><li><a href="AboutModal.html#_url">_url</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="AboutModal.html#._fillAttributes">_fillAttributes</a></li><li><a href="AboutModal.html#.destroy">destroy</a></li></ul></div></li><li><a href="CustomEvents.html">CustomEvents</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="CustomEvents_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="CustomEvents.html#_customEvents">_customEvents</a></li><li><a href="CustomEvents.html#_debug">_debug</a></li><li><a href="CustomEvents.html#_idIncrementor">_idIncrementor</a></li><li><a href="CustomEvents.html#_regularEvents">_regularEvents</a></li><li><a href="CustomEvents.html#version">version</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="CustomEvents.html#._clearRegularEvent">_clearRegularEvent</a></li><li><a href="CustomEvents.html#._raise">_raise</a></li><li><a href="CustomEvents.html#.addEvent">addEvent</a></li><li><a href="CustomEvents.html#.destroy">destroy</a></li><li><a href="CustomEvents.html#.publish">publish</a></li><li><a href="CustomEvents.html#.removeAllEvents">removeAllEvents</a></li><li><a href="CustomEvents.html#.removeEvent">removeEvent</a></li><li><a href="CustomEvents.html#.subscribe">subscribe</a></li><li><a href="CustomEvents.html#.unsubscribe">unsubscribe</a></li><li><a href="CustomEvents.html#.unsubscribeAllFor">unsubscribeAllFor</a></li></ul></div></li><li><a href="DragElement.html">DragElement</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="DragElement_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="DragElement.html#_data">_data</a></li><li><a href="DragElement.html#_eventIds">_eventIds</a></li><li><a href="DragElement.html#_target">_target</a></li><li><a href="DragElement.html#_touchPhantomDom">_touchPhantomDom</a></li><li><a href="DragElement.html#_touchStarted">_touchStarted</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="DragElement.html#._buildElements">_buildElements</a></li><li><a href="DragElement.html#._dragStart">_dragStart</a></li><li><a href="DragElement.html#._dragTouchEnd">_dragTouchEnd</a></li><li><a href="DragElement.html#._dragTouchMove">_dragTouchMove</a></li><li><a href="DragElement.html#._events">_events</a></li><li><a href="DragElement.html#.destroy">destroy</a></li></ul></div></li><li><a href="DropElement.html">DropElement</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="DropElement_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="DropElement.html#_eventIds">_eventIds</a></li><li><a href="DropElement.html#_movementCounter">_movementCounter</a></li><li><a href="DropElement.html#_onDropCB">_onDropCB</a></li><li><a href="DropElement.html#_target">_target</a></li><li><a href="DropElement.html#_transparentBorder">_transparentBorder</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="DropElement.html#._buildElements">_buildElements</a></li><li><a href="DropElement.html#._dragEnter">_dragEnter</a></li><li><a href="DropElement.html#._dragLeave">_dragLeave</a></li><li><a href="DropElement.html#._dragOver">_dragOver</a></li><li><a href="DropElement.html#._dragTouchEnd">_dragTouchEnd</a></li><li><a href="DropElement.html#._dragTouchOver">_dragTouchOver</a></li><li><a href="DropElement.html#._drop">_drop</a></li><li><a href="DropElement.html#._eventBehavior">_eventBehavior</a></li><li><a href="DropElement.html#._events">_events</a></li><li><a href="DropElement.html#._isTouchEventInTarget">_isTouchEventInTarget</a></li><li><a href="DropElement.html#.destroy">destroy</a></li></ul></div></li><li><a href="Kom.html">Kom</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Kom_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Kom.html#_csrfToken">_csrfToken</a></li><li><a href="Kom.html#_headers">_headers</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Kom.html#._checkValidity">_checkValidity</a></li><li><a href="Kom.html#._createRequestHeaders">_createRequestHeaders</a></li><li><a href="Kom.html#._getCsrfCookie">_getCsrfCookie</a></li><li><a href="Kom.html#._getErrorCodeFromHTTPStatus">_getErrorCodeFromHTTPStatus</a></li><li><a href="Kom.html#._resolveAs">_resolveAs</a></li><li><a href="Kom.html#._resolveAsJSON">_resolveAsJSON</a></li><li><a href="Kom.html#._resolveAsRaw">_resolveAsRaw</a></li><li><a href="Kom.html#._resolveAsText">_resolveAsText</a></li><li><a href="Kom.html#.get">get</a></li><li><a href="Kom.html#.getRaw">getRaw</a></li><li><a href="Kom.html#.getText">getText</a></li><li><a href="Kom.html#.post">post</a></li><li><a href="Kom.html#.postRaw">postRaw</a></li><li><a href="Kom.html#.postText">postText</a></li></ul></div></li><li><a href="Logger.html">Logger</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Logger_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Logger.html#_errors">_errors</a></li><li><a href="Logger.html#_log">_log</a></li><li><a href="Logger.html#_notification">_notification</a></li><li><a href="Logger.html#version">version</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Logger.html#._buildErrorInfo">_buildErrorInfo</a></li><li><a href="Logger.html#._getCallerName">_getCallerName</a></li><li><a href="Logger.html#._logErrorToConsole">_logErrorToConsole</a></li><li><a href="Logger.html#._logErrorToNotification">_logErrorToNotification</a></li><li><a href="Logger.html#.destroy">destroy</a></li><li><a href="Logger.html#.raise">raise</a></li></ul></div></li><li><a href="Modal.html">Modal</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Modal_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Modal.html#_closeButton">_closeButton</a></li><li><a href="Modal.html#_closeClickedEvtId">_closeClickedEvtId</a></li><li><a href="Modal.html#_modalOverlay">_modalOverlay</a></li><li><a href="Modal.html#_overlayClickedEvtId">_overlayClickedEvtId</a></li><li><a href="Modal.html#_rootElement">_rootElement</a></li><li><a href="Modal.html#_url">_url</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Modal.html#._fillAttributes">_fillAttributes</a></li><li><a href="Modal.html#._loadTemplate">_loadTemplate</a></li><li><a href="Modal.html#.close">close</a></li><li><a href="Modal.html#.destroy">destroy</a></li><li><a href="Modal.html#.open">open</a></li></ul></div></li><li><a href="Notification.html">Notification</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Notification_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Notification.html#_active">_active</a></li><li><a href="Notification.html#_default">_default</a></li><li><a href="Notification.html#_dismissAllLock">_dismissAllLock</a></li><li><a href="Notification.html#_dom">_dom</a></li><li><a href="Notification.html#_duration">_duration</a></li><li><a href="Notification.html#_maxActive">_maxActive</a></li><li><a href="Notification.html#_position">_position</a></li><li><a href="Notification.html#_queue">_queue</a></li><li><a href="Notification.html#_thickBorder">_thickBorder</a></li><li><a href="Notification.html#_transition">_transition</a></li><li><a href="Notification.html#version">version</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Notification.html#._attach">_attach</a></li><li><a href="Notification.html#._buildNotificationType">_buildNotificationType</a></li><li><a href="Notification.html#._buildUI">_buildUI</a></li><li><a href="Notification.html#._buildUIDom">_buildUIDom</a></li><li><a href="Notification.html#._checkCounter">_checkCounter</a></li><li><a href="Notification.html#._checkNotificationOptionsValidity">_checkNotificationOptionsValidity</a></li><li><a href="Notification.html#._clearRequestCount">_clearRequestCount</a></li><li><a href="Notification.html#._close">_close</a></li><li><a href="Notification.html#._decrementRequestCounter">_decrementRequestCounter</a></li><li><a href="Notification.html#._dim">_dim</a></li><li><a href="Notification.html#._events">_events</a></li><li><a href="Notification.html#._idGenerator">_idGenerator</a></li><li><a href="Notification.html#._incrementRequestCounter">_incrementRequestCounter</a></li><li><a href="Notification.html#._init">_init</a></li><li><a href="Notification.html#._open">_open</a></li><li><a href="Notification.html#._resetTimeout">_resetTimeout</a></li><li><a href="Notification.html#._setAttributesDefault">_setAttributesDefault</a></li><li><a href="Notification.html#._setOptionsDefault">_setOptionsDefault</a></li><li><a href="Notification.html#._setOptionsFallback">_setOptionsFallback</a></li><li><a href="Notification.html#._start">_start</a></li><li><a href="Notification.html#._unDim">_unDim</a></li><li><a href="Notification.html#.destroy">destroy</a></li><li><a href="Notification.html#.dismiss">dismiss</a></li><li><a href="Notification.html#.dismissAll">dismissAll</a></li><li><a href="Notification.html#.dismissType">dismissType</a></li><li><a href="Notification.html#.error">error</a></li><li><a href="Notification.html#.info">info</a></li><li><a href="Notification.html#.new">new</a></li><li><a href="Notification.html#.success">success</a></li><li><a href="Notification.html#.warning">warning</a></li></ul></div></li><li><a href="SceneView.html">SceneView</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="SceneView_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="SceneView.html#dom">dom</a></li><li><a href="SceneView.html#dom">dom</a></li><li><a href="SceneView.html#wrapper">wrapper</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="SceneView.html#.destroy">destroy</a></li></ul></div></li><li><a href="UserInterface.html">UserInterface</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="UserInterface_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="UserInterface.html#_aside">_aside</a></li><li><a href="UserInterface.html#_loadingOverlay">_loadingOverlay</a></li><li><a href="UserInterface.html#_scene">_scene</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="UserInterface.html#._fetchWrapper">_fetchWrapper</a></li><li><a href="UserInterface.html#._viewReady">_viewReady</a></li><li><a href="UserInterface.html#.setSceneView">setSceneView</a></li><li><a href="UserInterface.html#.startLoading">startLoading</a></li><li><a href="UserInterface.html#.startLoading">startLoading</a></li></ul></div></li><li><a href="ViewFactory.html">ViewFactory</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ViewFactory_sub"></div></li><li><a href="WishModal.html">WishModal</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="WishModal_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="WishModal.html#_closeButton">_closeButton</a></li><li><a href="WishModal.html#_closeClickedEvtId">_closeClickedEvtId</a></li><li><a href="WishModal.html#_modalOverlay">_modalOverlay</a></li><li><a href="WishModal.html#_overlayClickedEvtId">_overlayClickedEvtId</a></li><li><a href="WishModal.html#_rootElement">_rootElement</a></li><li><a href="WishModal.html#_submitEvtId">_submitEvtId</a></li><li><a href="WishModal.html#_submitInput">_submitInput</a></li><li><a href="WishModal.html#_url">_url</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="WishModal.html#._events">_events</a></li><li><a href="WishModal.html#._events">_events</a></li><li><a href="WishModal.html#._fillAttributes">_fillAttributes</a></li><li><a href="WishModal.html#._submitClicked">_submitClicked</a></li><li><a href="WishModal.html#.destroy">destroy</a></li></ul></div></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Aside from './component/Aside';
import Scene from './component/Scene';
import WishModal from './modal/menupage/WishModal.js';
'use strict';


class UserInterface {


  /** @summary &lt;h1>ManaZeak user interface controller&lt;/h1>
   * @author Arthur Beaulieu
   * @since September 2020
   * @description &lt;blockquote>This class is made to handle all interactions between UI and Mzk controller. It is in
   * charge to load views and to append them into the DOM, but also to make them interactive with the app context.&lt;/blockquote> */
  constructor() {
    /** @private
     * @member {object} - The aside controller */
    this._aside = new Aside();
    /** @private
     * @member {object} - The scene controller */
    this._scene = new Scene();
    /** @private
     * @member {object} - The DOM loading overlay to use in transitions */
    this._loadingOverlay = null;
    // Build loading overlay and add its style class
    this._loadingOverlay = document.getElementById('mzk-loading-overlay');
  }


  /*  --------------------------------------------------------------------------------------------------------------- */
  /*  -------------------------------------------  VIEW MANIPULATION  ----------------------------------------------  */
  /*                                                                                                                  */
  /*  These methods will set the single page with a new view, while properly cleaning the previously used one.        */
  /*  --------------------------------------------------------------------------------------------------------------- */


  /** @method
   * @name setSceneView
   * @public
   * @memberof UserInterface
   * @description &lt;blockquote>This method will try to build a view according to the given options. If options are
   * invalid, the Main Page will be loaded instead. It handle the transition with previous view to put a loading
   * overlay while loading the new view.&lt;/blockquote>
   * @param {object} options - The options to build the view from
   * @param {object} options.name - The view name, must match one in the ViewFactory class
   * @return {promise} - The action promise */
  setSceneView(options) {
    return new Promise((resolve, reject) => {
      this.startLoading()
        .then(this._scene.buildView.bind(this._scene, options))
        .then(resolve)
        .catch(reject)
        .finally(this.stopLoading.bind(this)); // Clear loading overlay whatever happens
    });
  }


  setModal(options) {
    return new Promise((resolve, reject) => {
      this._scene.buildModal(options)
        .then(resolve)
        .catch(reject);
    });
  }


  getFragment(url) {
    return new Promise((resolve, reject) => {
      mzk.kom.getText(url) // The loading overlay must be handled caller, since fragment is only a part of viewport
        .then(resolve)
        .catch(reject)
    });
  }


  processLogFromServer(errors) {
    if (errors &amp;&amp; errors.length > 0) {
      for (let i = 0; i &lt; errors.length; ++i) {
        Logger.raise(errors[i]);
      }
    }
  }


  /*  --------------------------------------------------------------------------------------------------------------- */
  /*  ----------------------------------------  LOADING OVERLAY METHODS  -------------------------------------------  */
  /*                                                                                                                  */
  /*  These methods add/remove the loading overlay on top of elements. It is meant to be used when switching view.    */
  /*  --------------------------------------------------------------------------------------------------------------- */


  /** @method
   * @name startLoading
   * @public
   * @memberof UserInterface
   * @description &lt;blockquote>The start loading method will add an overlay on the whole page that has a css animation.&lt;/blockquote>
   * @return {promise} - The action promise */
  startLoading() {
    return new Promise(resolve => {
      document.body.appendChild(this._loadingOverlay);
      requestAnimationFrame(resolve);
    });
  }


  /** @method
   * @name startLoading
   * @public
   * @memberof UserInterface
   * @description &lt;blockquote>The stop loading method will remove the overlay on the page.&lt;/blockquote>
   * @return {promise} - The action promise */
  stopLoading() {
    return new Promise(resolve => {
      document.body.removeChild(this._loadingOverlay);
      requestAnimationFrame(resolve);
    });
  }


}


export default UserInterface;
</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="https://manazeak.org/static/img/logo/manazeak-text.svg" style="width: auto; height: 13px">
    <div class="footer-text">&nbsp;&nbsp;ManaZeak is love</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
